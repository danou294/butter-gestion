{% extends 'scripts_manager/base.html' %}

{% block title %}Dashboard RevenueCat - Butter{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header -->
    <div class="card bg-base-100 shadow-sm border border-base-300">
        <div class="card-body flex-row flex-wrap items-center justify-between gap-4">
            <div>
                <h1 class="text-3xl font-serif font-bold text-base-content">üìä Dashboard RevenueCat</h1>
                <p class="text-secondary mt-1">M√©triques de revenus et abonnements</p>
            </div>
            <div class="flex items-center gap-4">
                <a href="{% url 'scripts_manager:users_list' %}" class="text-secondary hover:text-base-content">
                    ‚Üê Retour √† la liste
                </a>
                <a href="{% url 'scripts_manager:refresh_all_revenuecat' %}"
                   class="btn btn-primary"
                   onclick="return confirm('‚ö†Ô∏è Actualiser toutes les donn√©es RevenueCat ?');">
                    üîÑ Actualiser les donn√©es
                </a>
            </div>
        </div>
    </div>

    <!-- Dashboard Metrics -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Active Trials -->
        <div class="card bg-base-100 shadow-sm border border-base-300 hover:-translate-y-0.5 hover:shadow-md transition-all">
            <div class="card-body">
                <p class="text-sm font-medium text-secondary">Active Trials</p>
                <p class="text-4xl font-bold font-serif text-base-content mt-3 mb-2">{{ dashboard.active_trials }}</p>
                <p class="text-xs text-secondary">In total</p>
            </div>
        </div>

        <!-- Active Subscriptions -->
        <div class="card bg-base-100 shadow-sm border border-base-300 hover:-translate-y-0.5 hover:shadow-md transition-all">
            <div class="card-body">
                <p class="text-sm font-medium text-secondary">Active Subscriptions</p>
                <p class="text-4xl font-bold font-serif text-base-content mt-3 mb-2">{{ dashboard.active_subscriptions }}</p>
                <p class="text-xs text-secondary">In total</p>
            </div>
        </div>

        <!-- MRR -->
        <div class="card bg-base-100 shadow-sm border border-base-300 hover:-translate-y-0.5 hover:shadow-md transition-all">
            <div class="card-body">
                <p class="text-sm font-medium text-secondary">MRR</p>
                <p class="text-4xl font-bold font-serif text-base-content mt-3 mb-2">
                    <span class="text-2xl font-semibold">{{ dashboard.mrr }}</span>
                    <span class="text-lg text-secondary"> $US</span>
                </p>
                <p class="text-xs text-secondary">Monthly Recurring Revenue</p>
            </div>
        </div>

        <!-- Revenue -->
        <div class="card bg-base-100 shadow-sm border border-base-300 hover:-translate-y-0.5 hover:shadow-md transition-all">
            <div class="card-body">
                <p class="text-sm font-medium text-secondary">Revenue</p>
                <p class="text-4xl font-bold font-serif text-base-content mt-3 mb-2">
                    <span class="text-2xl font-semibold">{{ dashboard.revenue_28_days }}</span>
                    <span class="text-lg text-secondary"> $US</span>
                </p>
                <p class="text-xs text-secondary">Last 28 days</p>
            </div>
        </div>

        <!-- New Customers -->
        <div class="card bg-base-100 shadow-sm border border-base-300 hover:-translate-y-0.5 hover:shadow-md transition-all">
            <div class="card-body">
                <p class="text-sm font-medium text-secondary">New Customers</p>
                <p class="text-4xl font-bold font-serif text-base-content mt-3 mb-2">{{ dashboard.new_customers_28_days }}</p>
                <p class="text-xs text-secondary">Last 28 days</p>
            </div>
        </div>

        <!-- Active Customers -->
        <div class="card bg-base-100 shadow-sm border border-base-300 hover:-translate-y-0.5 hover:shadow-md transition-all">
            <div class="card-body">
                <p class="text-sm font-medium text-secondary">Active Customers</p>
                <p class="text-4xl font-bold font-serif text-base-content mt-3 mb-2">{{ dashboard.active_customers }}</p>
                <p class="text-xs text-secondary">Last 28 days</p>
            </div>
        </div>
    </div>

    <!-- Info Box -->
    <div class="card bg-base-200 shadow-sm border border-base-300">
        <div class="card-body">
            <h2 class="card-title text-lg font-serif font-bold text-base-content">‚ÑπÔ∏è Informations</h2>
            <ul class="text-sm text-secondary space-y-2 mt-2">
                <li>‚Ä¢ <strong>Active Trials</strong> : Nombre d'essais actuellement actifs</li>
                <li>‚Ä¢ <strong>Active Subscriptions</strong> : Nombre d'abonnements actifs (hors essais)</li>
                <li>‚Ä¢ <strong>MRR</strong> : Revenu r√©current mensuel bas√© sur les abonnements actifs</li>
                <li>‚Ä¢ <strong>Revenue</strong> : Revenu total g√©n√©r√© au cours des 28 derniers jours</li>
                <li>‚Ä¢ <strong>New Customers</strong> : Nouveaux clients ayant effectu√© un achat dans les 28 derniers jours</li>
                <li>‚Ä¢ <strong>Active Customers</strong> : Clients actifs (abonnements actifs + essais + p√©riode de gr√¢ce)</li>
                <li class="mt-4 text-xs opacity-70">‚ö†Ô∏è Les prix des produits sont estim√©s. Vous pouvez les ajuster dans le code si n√©cessaire.</li>
            </ul>
        </div>
    </div>
</div>
{% endblock %}
