{% extends 'scripts_manager/base.html' %}

{% block title %}Dashboard RevenueCat - Butter{% endblock %}

{% block extra_css %}
<style>
    .dashboard-card {
        background: #FFFFFF;
        border-radius: 14px;
        padding: 24px;
        border: 1px solid #C9C1B1;
        transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .dashboard-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .metric-value {
        font-size: 36px;
        font-weight: 700;
        font-family: 'Inria Serif', serif;
        color: #111111;
        margin: 12px 0 8px 0;
    }
    
    .metric-label {
        font-size: 14px;
        color: #535353;
        font-weight: 500;
    }
    
    .metric-subtitle {
        font-size: 12px;
        color: #6c757d;
        margin-top: 4px;
    }
    
    .currency {
        font-size: 24px;
        font-weight: 600;
    }
</style>
{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header -->
    <div class="bg-[#FFFFFF] rounded-[14px] shadow-sm p-6 border border-[#C9C1B1]">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-serif font-bold text-[#111111] mb-2">üìä Dashboard RevenueCat</h1>
                <p class="text-[#535353]">M√©triques de revenus et abonnements</p>
            </div>
            <div>
                <a href="{% url 'scripts_manager:users_list' %}" class="text-[#535353] hover:text-[#111111] mr-4">
                    ‚Üê Retour √† la liste
                </a>
                <a href="{% url 'scripts_manager:refresh_all_revenuecat' %}" 
                   class="btn-primary inline-block"
                   onclick="return confirm('‚ö†Ô∏è Actualiser toutes les donn√©es RevenueCat ?');">
                    üîÑ Actualiser les donn√©es
                </a>
            </div>
        </div>
    </div>
    
    <!-- Dashboard Metrics -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Active Trials -->
        <div class="dashboard-card">
            <div class="metric-label">Active Trials</div>
            <div class="metric-value">{{ dashboard.active_trials }}</div>
            <div class="metric-subtitle">In total</div>
        </div>
        
        <!-- Active Subscriptions -->
        <div class="dashboard-card">
            <div class="metric-label">Active Subscriptions</div>
            <div class="metric-value">{{ dashboard.active_subscriptions }}</div>
            <div class="metric-subtitle">In total</div>
        </div>
        
        <!-- MRR -->
        <div class="dashboard-card">
            <div class="metric-label">MRR</div>
            <div class="metric-value">
                <span class="currency">{{ dashboard.mrr }}</span>
                <span class="text-lg text-[#535353]"> $US</span>
            </div>
            <div class="metric-subtitle">Monthly Recurring Revenue</div>
        </div>
        
        <!-- Revenue -->
        <div class="dashboard-card">
            <div class="metric-label">Revenue</div>
            <div class="metric-value">
                <span class="currency">{{ dashboard.revenue_28_days }}</span>
                <span class="text-lg text-[#535353]"> $US</span>
            </div>
            <div class="metric-subtitle">Last 28 days</div>
        </div>
        
        <!-- New Customers -->
        <div class="dashboard-card">
            <div class="metric-label">New Customers</div>
            <div class="metric-value">{{ dashboard.new_customers_28_days }}</div>
            <div class="metric-subtitle">Last 28 days</div>
        </div>
        
        <!-- Active Customers -->
        <div class="dashboard-card">
            <div class="metric-label">Active Customers</div>
            <div class="metric-value">{{ dashboard.active_customers }}</div>
            <div class="metric-subtitle">Last 28 days</div>
        </div>
    </div>
    
    <!-- Info Box -->
    <div class="bg-[#F1EFEB] rounded-[14px] shadow-sm p-6 border border-[#C9C1B1]">
        <h2 class="text-lg font-serif font-bold text-[#111111] mb-3">‚ÑπÔ∏è Informations</h2>
        <ul class="text-sm text-[#535353] space-y-2">
            <li>‚Ä¢ <strong>Active Trials</strong> : Nombre d'essais actuellement actifs</li>
            <li>‚Ä¢ <strong>Active Subscriptions</strong> : Nombre d'abonnements actifs (hors essais)</li>
            <li>‚Ä¢ <strong>MRR</strong> : Revenu r√©current mensuel bas√© sur les abonnements actifs</li>
            <li>‚Ä¢ <strong>Revenue</strong> : Revenu total g√©n√©r√© au cours des 28 derniers jours</li>
            <li>‚Ä¢ <strong>New Customers</strong> : Nouveaux clients ayant effectu√© un achat dans les 28 derniers jours</li>
            <li>‚Ä¢ <strong>Active Customers</strong> : Clients actifs (abonnements actifs + essais + p√©riode de gr√¢ce)</li>
            <li class="mt-4 text-xs text-[#6c757d">‚ö†Ô∏è Les prix des produits sont estim√©s. Vous pouvez les ajuster dans le code si n√©cessaire.</li>
        </ul>
    </div>
</div>
{% endblock %}

