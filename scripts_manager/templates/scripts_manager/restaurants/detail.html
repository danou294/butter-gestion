{% extends 'scripts_manager/base.html' %}

{% block title %}{{ restaurant.name|default:"Restaurant" }} - Butter{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header -->
    <div class="card bg-base-100 shadow-sm border border-base-300">
        <div class="card-body flex-row flex-wrap items-center justify-between gap-4">
            <h1 class="text-3xl font-serif font-bold text-base-content">ğŸ½ï¸ {{ restaurant.name|default:"Restaurant" }}</h1>
            <div class="flex gap-2 flex-wrap">
                <a href="{% url 'scripts_manager:restaurant_edit' restaurant.id %}" class="btn btn-primary">âœï¸ Modifier</a>
                <a href="{% url 'scripts_manager:restaurants_list' %}" class="btn btn-ghost">â† Retour</a>
            </div>
        </div>
    </div>

    <!-- Informations -->
    <div class="card bg-base-100 shadow-sm border border-base-300">
        <div class="card-body">
            <h2 class="card-title font-serif text-base-content border-b border-base-300 pb-3">Informations</h2>
            <div class="overflow-x-auto">
                <table class="table">
                    <tr>
                        <td class="font-medium text-base-content w-48">ID :</td>
                        <td><code class="badge badge-ghost text-sm">{{ restaurant.id }}</code></td>
                    </tr>
                    {% for key, value in restaurant.items %}
                    {% if key != 'id' %}
                    <tr>
                        <td class="font-medium text-base-content w-48">{{ key|capfirst }} :</td>
                        <td class="text-secondary">
                            {% if value|length > 100 or value|length == 0 %}
                                <pre class="bg-base-200 p-4 rounded-box overflow-x-auto max-h-48 overflow-y-auto text-sm">{{ value }}</pre>
                            {% else %}
                                {{ value|default:"â€”" }}
                            {% endif %}
                        </td>
                    </tr>
                    {% endif %}
                    {% endfor %}
                </table>
            </div>
        </div>
    </div>

    <!-- JSON -->
    <div class="card bg-base-100 shadow-sm border border-base-300">
        <div class="card-body">
            <h2 class="card-title font-serif text-base-content border-b border-base-300 pb-3">JSON</h2>
            <pre id="json-display" class="bg-neutral text-neutral-content p-6 rounded-box overflow-x-auto text-sm max-h-96 overflow-y-auto"></pre>
        </div>
    </div>

    {{ restaurant|json_script:"restaurant-data" }}
    <script>
    const restaurantData = JSON.parse(document.getElementById('restaurant-data').textContent);
    document.getElementById('json-display').textContent = JSON.stringify(restaurantData, null, 2);
    </script>

    <!-- Actions -->
    <div class="flex flex-col md:flex-row gap-3">
        <form method="POST" action="{% url 'scripts_manager:restaurant_delete' restaurant.id %}" class="flex-1"
              x-data x-on:submit.prevent="if(confirm('ÃŠtes-vous sÃ»r de vouloir supprimer ce restaurant ?')) $el.submit()">
            {% csrf_token %}
            <button type="submit" class="btn btn-error w-full">ğŸ—‘ï¸ Supprimer</button>
        </form>
        <a href="{% url 'scripts_manager:restaurant_get_json' restaurant.id %}" class="btn btn-ghost flex-1 text-center" target="_blank">
            ğŸ“„ JSON
        </a>
    </div>
</div>
{% endblock %}
